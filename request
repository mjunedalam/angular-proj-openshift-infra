 getWellDataByEPANum(): Observable<ApiResponse<IWellData>> {
    return this.http.get<ApiResponse<IWellData>>(`${this.apiUrl}/drilling-eye`);
  } getWellDataByEPANum(): Observable<ApiResponse<IWellData>> {
    return this.http.get<ApiResponse<IWellData>>(`${this.apiUrl}/drilling-eye`);
  }
import { signalStore, withState, withMethods, patchState } from '@ngrx/signals';
import { inject } from '@angular/core';
import { ApiResponse } from '../../models/api-response.model';
import { IWellData } from '../../../models/well-design/wwell-data.model';
import { WwellDataService } from '../../../services/wwell-data.service';
import { LoadingService } from '../../services/loading.service';

interface WellDataState {

    response: ApiResponse<IWellData> | null;
}

export const wellDataStore = signalStore(
    { providedIn: 'root' },
    withState<WellDataState>({ response: null }),
    withMethods(
        (
            store,
            service = inject(WwellDataService),
            loading = inject(LoadingService)
        ) => ({

            loadWellData: () => {
                loading.show();
                patchState(store, { response: null });

                service.getWellData().subscribe({
                    next: (res) => {
                        console.log("well data ", res);
                        patchState(store, { response: res });
                        loading.hide();
                    },
                    error: (err) => {
                        patchState(store, {
                            response: {
                                statusCode: 500,
                                error: true,
                                message: err.message,
                                data: [],
                            },
                        });
                        loading.hide();
                    },
                });
            },


            refresh: () => {
                loading.show();
                service.getWellData().subscribe({
                    next: (res) => patchState(store, { response: res }),
                    error: (err) =>
                        patchState(store, {
                            response: {
                                statusCode: 500,
                                error: true,
                                message: err.message,
                                data: [],
                            },
                        }),
                    complete: () => loading.hide(),
                });
            },
        })
    )
);

   @GET
    public Response getDrillingEyeDataByEPNum(@QueryParam("epNum") String epNum) {
        LOGGER.log(Level.INFO, "getDrillingEyeData executed with ", epNum);
        ApiResponse<String> apiResponse = drillingEyeService.loadDrillingData(epNum);
        return apiResponse.buildResponse();
    }
